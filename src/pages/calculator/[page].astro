---
import Layout from '@layouts/Layout.astro';
import CompactCard from '@components/CompactCard.astro';
import Pagination from '@components/Pagination.astro';
import { getSlug } from '@utils/lookup.js';
import type { Item } from '@utils/lookup.js';
import data from '@datav2/Products.json';

export async function getStaticPaths({ paginate }: { paginate: <T>(data: T[], options: { pageSize: number }) => unknown[] }) {
	return paginate((data as Item[]).sort((a: Item, b: Item) => b.BaseValueUnits - a.BaseValueUnits), { pageSize: 78 });
}
// All paginated data is passed on the "page" prop
interface PageProps {
	page: {
		data: Item[];
		currentPage: number;
		lastPage: number;
		url: {
			prev?: string;
			next?: string;
		};
	};
}
const { page } = Astro.props as PageProps;
---

<Layout
	title="Crafting Calculator | No Man's Sky Recipes, Crafting Guide and Cooking Guide"
	description="A calculator to help your farming efforts by calculating exactly what you need to craft any item."
	slug="calculator"
>
	<h1 class="text-center text-4xl sm:text-6xl mt-2">Crafting Calculator</h1>
	<p class="text-xl text-center mt-3 mb-8">Choose an item below to start</p>
	<div id="items" class="grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8">
		{
			page.data.map((item, index) =>
				('RequiredItems' in item && item.RequiredItems && item.RequiredItems.length > 0) ? (
					<CompactCard
						card={{
							name: item.Name,
							image: 'https://nomansskyrecipes.com/images/items/' + item.Icon,
							link: getSlug(item),
						}}
						index={index}
					/>
				) : null
			)
		}
	</div>
	<Pagination page={page} />
</Layout>
